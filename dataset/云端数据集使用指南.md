# 大体积数据集云端使用指南（手把手教程）

代码用 Git 同步，大体积数据集不要放进 Git。下面三种方式任选一种，按步骤操作即可。

---

## 方案一：腾讯云 COS（推荐，和 Cloud Studio 同厂）

适合：数据集很大、要长期在云端训练、希望上传一次多处使用。

### 第一步：在腾讯云创建 COS 存储桶

1. **登录腾讯云控制台**  
   打开：https://console.cloud.tencent.com/  
   用你的腾讯云账号登录（和 Cloud Studio 同一账号即可）。

2. **进入对象存储 COS**  
   在控制台搜索「对象存储」或「COS」，进入 **对象存储** 产品页。

3. **创建存储桶**  
   - 点击 **存储桶列表** → **创建存储桶**。  
   - **名称**：自定义，例如 `minimind-dataset`（若提示已存在可加后缀如 `minimind-dataset-01`）。  
   - **地域**：选和 Cloud Studio 工作空间相同或就近地域（如「上海」），便于下载更快。  
   - **访问权限**：  
     - 若只想自己用：选 **私有读写**，后面用 coscmd 或预签名 URL 下载。  
     - 若图省事、且数据可公开：选 **公有读私有写**，之后可直接用控制台复制对象地址下载。  
   - 其他保持默认，点击 **确定** 完成创建。

4. **记下存储桶信息**  
   创建完成后，在存储桶列表里能看到：  
   - **存储桶名称**：格式为 `minimind-dataset-1234567890`（名称-APPID）。  
   - **地域**：如 `ap-shanghai`。  
   后面配置 coscmd 时会用到。

---

### 第二步：在本地把数据集上传到 COS

任选一种方式即可。

#### 方式 A：控制台网页上传（适合单次、文件不太多）

1. 在 COS 控制台点击刚创建的 **存储桶名称** 进入。  
2. 进入 **文件列表**，点击 **上传文件**。  
3. 选择你本机 `minimind/dataset/` 下的数据文件（或整个压缩包），可多选。  
4. **存储路径** 可留空（即根目录）或填 `dataset/`。  
5. 点击 **上传**，等待完成。

#### 方式 B：本机用 coscmd 上传（适合大文件、需多次上传）

1. **安装 coscmd**（在本地 PowerShell 或 CMD 里，先激活你的 venv 再装）：

   ```powershell
   pip install coscmd
   ```

2. **获取密钥**（仅首次需要）：  
   - 打开：https://console.cloud.tencent.com/cam/capi  
   - 若没有密钥，点击 **新建密钥**，生成 **SecretId** 和 **SecretKey**。  
   - 复制保存（SecretKey 只显示一次，注意保管）。

3. **配置 coscmd**（把下面换成你的信息）：

   ```powershell
   coscmd config -a 你的SecretId -s 你的SecretKey -b 存储桶名称-APPID -r 地域
   ```

   示例：

   ```powershell
   coscmd config -a AKIDxxxx -s xxxxx -b minimind-dataset-1234567890 -r ap-shanghai
   ```

   提示输入时直接回车即可。

4. **上传数据集**（在项目根目录下执行）：

   ```powershell
   cd C:\code\python\minimind
   # 上传整个 dataset 目录到 COS 的 dataset/ 前缀下
   coscmd upload dataset/ dataset/ -r
   ```

   若你只有一个压缩包 `dataset/data.zip`：

   ```powershell
   coscmd upload dataset/data.zip dataset/data.zip
   ```

---

### 第三步：在 Cloud Studio 里把数据下载到 dataset/

Cloud Studio 工作空间需要能访问到 COS 里的文件，任选一种即可。

#### 方式 A：控制台复制“对象地址”下载（存储桶为公有读时）

1. 在 COS 控制台 → 该存储桶 → **文件列表**，找到你上传的文件。  
2. 点击右侧 **详情**，在 **对象地址** 一栏复制完整 URL（形如 `https://xxx.cos.ap-shanghai.myqcloud.com/dataset/xxx`）。  
3. 在 **Cloud Studio** 里打开终端，进入项目目录后执行（把 URL 换成你复制的）：

   ```bash
   cd ~/minimind   # 或你的项目实际路径
   mkdir -p dataset
   wget -O dataset/data.zip "你复制的对象地址"
   # 若是分卷或多个文件，可多次 wget 到 dataset/
   ```

   若无 `wget`，可用：

   ```bash
   curl -L -o dataset/data.zip "你复制的对象地址"
   ```

#### 方式 B：在 Cloud Studio 里用 coscmd 下载（推荐，私有桶也可用）

1. 在 **Cloud Studio** 里打开终端，进入项目目录：

   ```bash
   cd ~/minimind
   mkdir -p dataset
   ```

2. **安装并配置 coscmd**（和本机一样，用同一批 SecretId/SecretKey 和存储桶）：

   ```bash
   pip install coscmd
   coscmd config -a 你的SecretId -s 你的SecretKey -b 存储桶名称-APPID -r 地域
   ```

3. **下载整个 dataset 目录到当前 dataset/**：

   ```bash
   coscmd download dataset/ dataset/ -r
   ```

   若只上传了一个文件 `dataset/data.zip`：

   ```bash
   coscmd download dataset/data.zip dataset/data.zip
   ```

4. 下载完成后，你的训练脚本直接读 `dataset/` 下的文件即可，无需改代码路径。

---

### 小结（方案一）

| 步骤       | 你在哪里做           | 做什么 |
|------------|----------------------|--------|
| 创建桶     | 腾讯云控制台         | COS → 创建存储桶，记下名称和地域 |
| 上传数据   | 本机（控制台或 coscmd） | 把 dataset 或压缩包上传到 COS |
| 云端下载   | Cloud Studio 终端    | wget/curl 或 coscmd 下载到 `dataset/` |

之后每次新开 Cloud Studio 工作空间时，只需再执行一次「第三步」的下载；代码照常 `git pull` 即可。

---

## 方案二：本机用 SCP 直接传到 Cloud Studio（上传一次即可）

适合：数据只在你这台电脑上、不想用 COS、愿意用 SSH 传一次。

### 第一步：在 Cloud Studio 获取 SSH 连接信息

1. 打开 **Cloud Studio**，进入你的工作空间。  
2. 确保工作空间是 **运行中** 状态，且是 **预置环境**（只有预置环境才支持 SSH）。  
3. 在界面找到 **SSH** 小图标（或「连接」/「终端」旁的 SSH 入口），点击。  
4. 复制显示的 **SSH 登录命令**，形如：  
   `ssh root@xxx-xxx.tencentcloudapi.com -p 22 -i /path/to/key`  
   或简化成：`root@主机名` + 端口 + 密钥路径。  
5. 若提供的是密钥文件下载链接，在本地下载并记住路径（如 `C:\Users\你的用户名\.ssh\cloudstudio_key`）。

---

### 第二步：在本地把 dataset 传到 Cloud Studio

#### 方式 A：PowerShell 用 scp（Windows 10/11 自带）

1. 打开 **PowerShell**，进入项目目录：

   ```powershell
   cd C:\code\python\minimind
   ```

2. 执行 scp（**务必把下面三处改成你的**）：  
   - `你的密钥路径`：例如 `C:\Users\18268\.ssh\cloudstudio_key`  
   - `主机`：Cloud Studio 给的 host，如 `xxx-xxx.tencentcloudapi.com`  
   - `端口`：通常是 `22`，若 SSH 命令里是 `-p 其他数字` 则改成该数字  
   - **远程路径**：Cloud Studio 工作空间里的项目路径，一般是 `/root/` 下你的工作空间名，例如 `/root/minimind`

   ```powershell
   scp -i "你的密钥路径" -P 端口 -r dataset root@主机:/root/minimind/
   ```

   **示例**（按你的实际改）：

   ```powershell
   scp -i "C:\Users\18268\.ssh\cloudstudio_key" -P 22 -r dataset root@ws-xxx.tencentcloudapi.com:/root/minimind/
   ```

   - `-r` 表示整个目录递归上传。  
   - 若只有一个大文件，可把 `dataset` 改成 `dataset\data.zip`，远程路径改成 `/root/minimind/dataset/`。

3. 首次连接可能提示「是否信任主机」，输入 `yes` 回车。  
4. 等待传输完成。完成后在 Cloud Studio 里打开终端，执行 `ls dataset/` 应能看到文件。

#### 方式 B：用 WinSCP（图形界面）

1. 下载安装 WinSCP：https://winscp.net/  
2. 新建站点：  
   - **文件协议**：SFTP  
   - **主机名**：Cloud Studio SSH 信息里的主机名  
   - **端口**：22（或 SSH 命令里的端口）  
   - **用户名**：通常是 `root`  
   - **认证**：选择「密钥」，浏览选择你下载的 Cloud Studio 密钥文件（.pem 等）  
3. 登录后，左侧选本机 `C:\code\python\minimind\dataset`，右侧进入远程的 `minimind` 目录，把 `dataset` 拖到右侧上传。

---

### 第三步：之后在 Cloud Studio 里训练

- 数据已在工作空间的 `minimind/dataset/` 下，直接运行训练脚本即可。  
- 若你**新开了一个工作空间**（新机器），需要再按「第二步」用 SCP 传一次 dataset，或改用方案一（COS）只下载一次。

---

### 小结（方案二）

| 步骤     | 你在哪里做     | 做什么 |
|----------|----------------|--------|
| 获取 SSH | Cloud Studio   | 运行中工作空间 → SSH 图标 → 复制命令、下载密钥 |
| 上传数据 | 本机 PowerShell 或 WinSCP | scp 或拖拽，把 `dataset` 传到远程 `minimind/` 下 |
| 训练     | Cloud Studio   | 代码 `git pull`，直接跑训练 |

---

## 方案三：网盘直链 + 云端 wget/curl（适合有直链时）

若数据集已在 阿里云盘、百度网盘 等，且能拿到**直接下载链接**（浏览器复制链接后能在新标签页直接开始下载的那种）：

1. 在 **Cloud Studio** 终端里：

   ```bash
   cd ~/minimind
   mkdir -p dataset
   wget -O dataset/data.zip "粘贴直链"
   # 或
   curl -L -o dataset/data.zip "粘贴直链"
   ```

2. 很多网盘没有真正直链（会跳登录页），此时无法用 wget/curl，建议用方案一或方案二。

---

## 三种方案对比

| 方案     | 优点                     | 缺点                     | 适合场景           |
|----------|--------------------------|--------------------------|--------------------|
| 一 COS   | 上传一次，多环境可下载；和 Cloud Studio 同厂 | 需在腾讯云开 COS         | 大体积、长期训练   |
| 二 SCP   | 不依赖 COS，本机直传     | 新工作空间需重传         | 数据只在本地、传一次 |
| 三 直链  | 操作简单                 | 很多网盘无直链           | 已有直链时         |

---

## 建议

- **长期用、数据很大**：用 **方案一（COS）**，按上面「创建桶 → 本地上传 → 云端 coscmd/wget 下载」做一遍即可。  
- **数据只在你这台电脑、偶尔训练**：用 **方案二（SCP）** 传一次到当前 Cloud Studio 工作空间即可。  
- 代码始终用 **Git**：本地改完 `git push`，Cloud Studio 里 `git pull`，不要用 Git 传数据集。

如有某一步报错，把**具体报错信息**和**你执行的那条命令**发出来，我可以按报错帮你排查。
